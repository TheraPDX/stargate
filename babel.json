{
  "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/server.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } };\n\nvar express = require(\"express\");\nvar bodyParser = require(\"body-parser\");\nvar session = require(\"express-session\");\nvar cachify = require(\"connect-cachify\");\nvar ejs = require(\"ejs\");\n// var exec = require('child_process').exec;\n// var motion = require(process.cwd() + '/web/src/utils/motion');\nvar loadRoutes = require(\"./routes/load\");\n\nvar Server = (function () {\n\tfunction Server() {\n\t\t_classCallCheck(this, Server);\n\n\t\t// this.config = {};\n\n\t\t// this.motion = new motion();\n\t\t// this.motion.setConfig(process.cwd() + '/config/motion/confcam.conf');\n\n\t\tthis.server = express();\n\n\t\tthis.server.use(bodyParser.urlencoded({ extended: true }));\n\t\tthis.server.use(bodyParser.json());\n\t\tthis.server.use(\"/assets\", express[\"static\"](\"web/assets\"));\n\t\tthis.server.use(\"/video\", express[\"static\"](\"visio/motion_detection\"));\n\n\t\tthis.initSession();\n\t\tthis.initCache();\n\t\tthis.initTemplate();\n\n\t\t// exec('lsusb', (error, stdout, stderr) => {\n\t\t// \tthis.webcamConnect = /(cam|webcam)/g.test(stdout);\n\t\t// \tif(this.webcamConnect){\n\t\t// \t\tthis.motion.start();\n\t\t// \t\tthis.webcamRunning = true;\n\t\t// \t}\n\t\t// });\n\t}\n\n\t_createClass(Server, {\n\t\tset: {\n\t\t\tvalue: function set(name, value) {\n\t\t\t\tvar key = undefined;\n\t\t\t\tif (\"object\" === typeof name && undefined === value) {\n\t\t\t\t\tfor (key in name) {\n\t\t\t\t\t\tthis[key] = name[key];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis[name] = value;\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\t\t},\n\t\tloadRoutes: {\n\t\t\tvalue: (function (_loadRoutes) {\n\t\t\t\tvar _loadRoutesWrapper = function loadRoutes() {\n\t\t\t\t\treturn _loadRoutes.apply(this, arguments);\n\t\t\t\t};\n\n\t\t\t\t_loadRoutesWrapper.toString = function () {\n\t\t\t\t\treturn _loadRoutes.toString();\n\t\t\t\t};\n\n\t\t\t\treturn _loadRoutesWrapper;\n\t\t\t})(function () {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tvar i = 0,\n\t\t\t\t    j = undefined,\n\t\t\t\t    sizeAll = loadRoutes.length,\n\t\t\t\t    sizeRoute = undefined,\n\t\t\t\t    route = undefined,\n\t\t\t\t    routes = undefined,\n\t\t\t\t    dep = undefined;\n\t\t\t\tfor (; i < sizeAll; i++) {\n\t\t\t\t\troutes = loadRoutes[i];\n\n\t\t\t\t\tfor (j = 0, sizeRoute = routes.length, dep = {}; j < sizeRoute; j++) {\n\t\t\t\t\t\troute = routes[j];\n\n\t\t\t\t\t\tif (route.dep) {\n\t\t\t\t\t\t\troute.dep.forEach(function (el) {\n\t\t\t\t\t\t\t\tdep[el] = _this[el];\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.server[route.type](route.url, route.call.bind(dep));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t})\n\t\t},\n\t\tinitTemplate: {\n\t\t\tvalue: function initTemplate() {\n\t\t\t\tthis.server.set(\"view engine\", \"ejs\");\n\t\t\t\tthis.server.set(\"views\", \"web/src/views\");\n\t\t\t}\n\t\t},\n\t\tinitCache: {\n\t\t\tvalue: function initCache() {\n\t\t\t\tvar assets = {\n\t\t\t\t\t\"/assets/app.min.js\": [\"/assets/app.js\"]\n\t\t\t\t};\n\n\t\t\t\tthis.server.use(cachify.setup(assets, {\n\t\t\t\t\troot: \"./web/\",\n\t\t\t\t\tproduction: process.env.NODE_ENV != \"development\" }));\n\t\t\t}\n\t\t},\n\t\tinitSession: {\n\t\t\tvalue: function initSession() {\n\t\t\t\tthis.server.use(session({\n\t\t\t\t\tsecret: \"keyboard cat\",\n\t\t\t\t\tresave: false,\n\t\t\t\t\tsaveUninitialized: true,\n\t\t\t\t\tcookie: { maxAge: 600000 }\n\t\t\t\t}));\n\n\t\t\t\tthis.server.use(function (req, res, next) {\n\t\t\t\t\tvar sess = req.session;\n\t\t\t\t\tif (sess.views && \"/user/login\" !== req.originalUrl || !sess.views && \"/user/login\" === req.originalUrl) {\n\t\t\t\t\t\tnext();\n\t\t\t\t\t} else if (sess.views && \"/user/login\" === req.originalUrl) {\n\t\t\t\t\t\tres.redirect(\"/\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsess.views = false;\n\t\t\t\t\t\tif (req.xhr || req.headers.accept.indexOf(\"json\") > -1) {\n\t\t\t\t\t\t\tres.status(401).json({\n\t\t\t\t\t\t\t\tresponse: false,\n\t\t\t\t\t\t\t\terrors: {\n\t\t\t\t\t\t\t\t\tmessage: \"You should be connected for to have access\",\n\t\t\t\t\t\t\t\t\tredirect: \"/user/login\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tres.redirect(\"/user/login\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tstart: {\n\t\t\tvalue: function start() {\n\t\t\t\tvar http = undefined;\n\t\t\t\tif (process.env.NODE_ENV != \"development\") {\n\t\t\t\t\tvar fs = require(\"fs\"),\n\t\t\t\t\t    options = {\n\t\t\t\t\t\tkey: fs.readFileSync(\"server.key\"),\n\t\t\t\t\t\tcert: fs.readFileSync(\"server.crt\")\n\t\t\t\t\t};\n\t\t\t\t\thttp = require(\"https\").createServer(options, this.server);\n\t\t\t\t} else {\n\t\t\t\t\thttp = require(\"http\").createServer(this.server);\n\t\t\t\t}\n\n\t\t\t\thttp.listen(process.env.PORT || 7070, function () {\n\t\t\t\t\tconsole.log(\"Server is listening...\");\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\treturn Server;\n})();\n\nmodule.exports = Server;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS93ZWIvc2VydmVyL3NlcnZlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFJLE9BQU8sR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDakMsSUFBSSxVQUFVLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ3hDLElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ3pDLElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ3pDLElBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQzs7O0FBR3pCLElBQUksVUFBVSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQzs7SUFFcEMsTUFBTTtBQUNBLFVBRE4sTUFBTSxHQUNFO3dCQURSLE1BQU07Ozs7Ozs7QUFPVixNQUFJLENBQUMsTUFBTSxHQUFHLE9BQU8sRUFBRSxDQUFDOztBQUd4QixNQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztBQUMzRCxNQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUNuQyxNQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsT0FBTyxVQUFPLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQztBQUN6RCxNQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsT0FBTyxVQUFPLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDOztBQUVwRSxNQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7QUFDbkIsTUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO0FBQ2pCLE1BQUksQ0FB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RSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDM0QsTUFDRztBQUNILFNBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztLQUNqRDs7QUFFRCxRQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxJQUFJLElBQUksRUFBRSxZQUFZO0FBQ2pELFlBQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLENBQUMsQ0FBQztLQUN0QyxDQUFDLENBQUM7SUFDSDs7OztRQWxJSSxNQUFNOzs7aUJBcUlHLE1BQU0iLCJmaWxlIjoiL2hvbWUvbGJlcnRyYW5kL1TDqWzDqWNoYXJnZW1lbnRzL1BFUlNPL3N0YXJnYXRlL3dlYi9zZXJ2ZXIvc2VydmVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG52YXIgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XG52YXIgc2Vzc2lvbiA9IHJlcXVpcmUoJ2V4cHJlc3Mtc2Vzc2lvbicpO1xudmFyIGNhY2hpZnkgPSByZXF1aXJlKCdjb25uZWN0LWNhY2hpZnknKTtcbnZhciBlanMgPSByZXF1aXJlKCdlanMnKTtcbi8vIHZhciBleGVjID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWM7XG4vLyB2YXIgbW90aW9uID0gcmVxdWlyZShwcm9jZXNzLmN3ZCgpICsgJy93ZWIvc3JjL3V0aWxzL21vdGlvbicpO1xudmFyIGxvYWRSb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy9sb2FkJyk7XG5cbmNsYXNzIFNlcnZlcntcblx0Y29uc3RydWN0b3IoKXtcblx0XHQvLyB0aGlzLmNvbmZpZyA9IHt9O1xuXG5cdFx0Ly8gdGhpcy5tb3Rpb24gPSBuZXcgbW90aW9uKCk7XG5cdFx0Ly8gdGhpcy5tb3Rpb24uc2V0Q29uZmlnKHByb2Nlc3MuY3dkKCkgKyAnL2NvbmZpZy9tb3Rpb24vY29uZmNhbS5jb25mJyk7XG5cblx0XHR0aGlzLnNlcnZlciA9IGV4cHJlc3MoKTtcblxuXG5cdFx0dGhpcy5zZXJ2ZXIudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTtcblx0XHR0aGlzLnNlcnZlci51c2UoYm9keVBhcnNlci5qc29uKCkpO1xuXHRcdHRoaXMuc2VydmVyLnVzZSgnL2Fzc2V0cycsIGV4cHJlc3Muc3RhdGljKCd3ZWIvYXNzZXRzJykpO1xuXHRcdHRoaXMuc2VydmVyLnVzZSgnL3ZpZGVvJywgZXhwcmVzcy5zdGF0aWMoJ3Zpc2lvL21vdGlvbl9kZXRlY3Rpb24nKSk7XG5cblx0XHR0aGlzLmluaXRTZXNzaW9uKCk7XG5cdFx0dGhpcy5pbml0Q2FjaGUoKTtcblx0XHR0aGlzLmluaXRUZW1wbGF0ZSgpO1xuXG5cdFx0Ly8gZXhlYygnbHN1c2InLCAoZXJyb3IsIHN0ZG91dCwgc3RkZXJyKSA9PiB7XG5cdFx0Ly8gXHR0aGlzLndlYmNhbUNvbm5lY3QgPSAvKGNhbXx3ZWJjYW0pL2cudGVzdChzdGRvdXQpO1xuXHRcdC8vIFx0aWYodGhpcy53ZWJjYW1Db25uZWN0KXtcblx0XHQvLyBcdFx0dGhpcy5tb3Rpb24uc3RhcnQoKTtcblx0XHQvLyBcdFx0dGhpcy53ZWJjYW1SdW5uaW5nID0gdHJ1ZTtcblx0XHQvLyBcdH1cblx0XHQvLyB9KTtcblx0fVxuXG5cdHNldChuYW1lLCB2YWx1ZSl7XG5cdFx0bGV0IGtleTtcblx0XHRpZignb2JqZWN0JyA9PT0gdHlwZW9mIG5hbWUgJiYgdW5kZWZpbmVkID09PSB2YWx1ZSl7XG5cdFx0XHRmb3Ioa2V5IGluIG5hbWUpe1xuXHRcdFx0XHR0aGlzW2tleV0gPSBuYW1lW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGVsc2V7XG5cdFx0XHR0aGlzW25hbWVdID0gdmFsdWU7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0bG9hZFJvdXRlcygpe1xuXHRcdGxldCBpID0gMCwgaiwgc2l6ZUFsbCA9IGxvYWRSb3V0ZXMubGVuZ3RoLCBzaXplUm91dGUsIHJvdXRlLCByb3V0ZXMsIGRlcDtcblx0XHRmb3IoOyBpIDwgc2l6ZUFsbDsgaSsrKXtcblx0XHRcdHJvdXRlcyA9IGxvYWRSb3V0ZXNbaV07XG5cblx0XHRcdGZvcihqID0gMCwgc2l6ZVJvdXRlID0gcm91dGVzLmxlbmd0aCwgZGVwID0ge307IGogPCBzaXplUm91dGU7IGorKyl7XG5cdFx0XHRcdHJvdXRlID0gcm91dGVzW2pdO1xuXG5cdFx0XHRcdGlmKHJvdXRlLmRlcCl7XG5cdFx0XHRcdFx0cm91dGUuZGVwLmZvckVhY2goKGVsKSA9PiB7XG5cdFx0XHRcdFx0XHRkZXBbZWxdID0gdGhpc1tlbF07XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLnNlcnZlcltyb3V0ZS50eXBlXShyb3V0ZS51cmwsIHJvdXRlLmNhbGwuYmluZChkZXApKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRpbml0VGVtcGxhdGUoKXtcblx0XHR0aGlzLnNlcnZlci5zZXQoJ3ZpZXcgZW5naW5lJywgJ2VqcycpO1xuXHRcdHRoaXMuc2VydmVyLnNldCgndmlld3MnLCAnd2ViL3NyYy92aWV3cycpO1xuXHR9XG5cblx0aW5pdENhY2hlKCl7XG5cdFx0bGV0IGFzc2V0cyA9IHtcblx0XHRcdFwiL2Fzc2V0cy9hcHAubWluLmpzXCI6IFsgXCIvYXNzZXRzL2FwcC5qc1wiIF1cblx0XHR9O1xuXG5cdFx0dGhpcy5zZXJ2ZXIudXNlKGNhY2hpZnkuc2V0dXAoYXNzZXRzLCB7XG5cdFx0XHRyb290OiBcIi4vd2ViL1wiLFxuXHRcdFx0cHJvZHVjdGlvbjogKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9IFwiZGV2ZWxvcG1lbnRcIiksXG5cdFx0fSkpO1xuXHR9XG5cblx0aW5pdFNlc3Npb24oKXtcblx0XHR0aGlzLnNlcnZlci51c2Uoc2Vzc2lvbih7XG5cdFx0XHRzZWNyZXQ6ICdrZXlib2FyZCBjYXQnLFxuXHRcdFx0cmVzYXZlOiBmYWxzZSxcblx0XHRcdHNhdmVVbmluaXRpYWxpemVkOiB0cnVlLFxuXHRcdFx0Y29va2llOiB7IG1heEFnZTogNjAwMDAwIH1cblx0XHR9KSk7XG5cblx0XHR0aGlzLnNlcnZlci51c2UoZnVuY3Rpb24gKHJlcSwgcmVzLCBuZXh0KSB7XG5cdFx0XHRsZXQgc2VzcyA9IHJlcS5zZXNzaW9uO1xuXHRcdFx0aWYgKChzZXNzLnZpZXdzICYmICcvdXNlci9sb2dpbicgIT09IHJlcS5vcmlnaW5hbFVybCkgfHwgKCFzZXNzLnZpZXdzICYmICcvdXNlci9sb2dpbicgPT09IHJlcS5vcmlnaW5hbFVybCkpIHtcblx0XHRcdFx0bmV4dCgpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZihzZXNzLnZpZXdzICYmICcvdXNlci9sb2dpbicgPT09IHJlcS5vcmlnaW5hbFVybCl7XG5cdFx0XHRcdHJlcy5yZWRpcmVjdCgnLycpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHNlc3Mudmlld3MgPSBmYWxzZTtcblx0XHRcdFx0aWYocmVxLnhociB8fCByZXEuaGVhZGVycy5hY2NlcHQuaW5kZXhPZignanNvbicpID4gLTEpe1xuXHRcdFx0XHRcdHJlc1xuXHRcdFx0XHRcdFx0LnN0YXR1cyg0MDEpXG5cdFx0XHRcdFx0XHQuanNvbih7XG5cdFx0XHRcdFx0XHRcdFwicmVzcG9uc2VcIjpmYWxzZSxcblx0XHRcdFx0XHRcdFx0XCJlcnJvcnNcIjoge1xuXHRcdFx0XHRcdFx0XHRcdFwibWVzc2FnZVwiOiBcIllvdSBzaG91bGQgYmUgY29ubmVjdGVkIGZvciB0byBoYXZlIGFjY2Vzc1wiLFxuXHRcdFx0XHRcdFx0XHRcdFwicmVkaXJlY3RcIjpcIi91c2VyL2xvZ2luXCJcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZXtcblx0XHRcdFx0XHRyZXMucmVkaXJlY3QoJy91c2VyL2xvZ2luJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHN0YXJ0KCl7XG5cdFx0bGV0IGh0dHA7XG5cdFx0aWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9IFwiZGV2ZWxvcG1lbnRcIil7XG5cdFx0XHRsZXQgZnMgPSByZXF1aXJlKCdmcycpLFxuXHRcdFx0XHRcdG9wdGlvbnMgPSB7XG5cdFx0XHRcdFx0XHRrZXkgIDogZnMucmVhZEZpbGVTeW5jKCdzZXJ2ZXIua2V5JyksXG5cdFx0XHRcdFx0XHRjZXJ0IDogZnMucmVhZEZpbGVTeW5jKCdzZXJ2ZXIuY3J0Jylcblx0XHRcdFx0XHR9O1xuXHRcdFx0aHR0cCA9IHJlcXVpcmUoJ2h0dHBzJykuY3JlYXRlU2VydmVyKG9wdGlvbnMsIHRoaXMuc2VydmVyKTtcblx0XHR9XG5cdFx0ZWxzZXtcblx0XHRcdGh0dHAgPSByZXF1aXJlKCdodHRwJykuY3JlYXRlU2VydmVyKHRoaXMuc2VydmVyKTtcblx0XHR9XG5cblx0XHRodHRwLmxpc3Rlbihwcm9jZXNzLmVudi5QT1JUIHx8IDcwNzAsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdTZXJ2ZXIgaXMgbGlzdGVuaW5nLi4uJyk7XG5cdFx0fSk7XG5cdH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VydmVyO1xuIl19",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/server.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/server.js",
      "sourcesContent": [
        "var express = require('express');\nvar bodyParser = require('body-parser');\nvar session = require('express-session');\nvar cachify = require('connect-cachify');\nvar ejs = require('ejs');\n// var exec = require('child_process').exec;\n// var motion = require(process.cwd() + '/web/src/utils/motion');\nvar loadRoutes = require('./routes/load');\n\nclass Server{\n\tconstructor(){\n\t\t// this.config = {};\n\n\t\t// this.motion = new motion();\n\t\t// this.motion.setConfig(process.cwd() + '/config/motion/confcam.conf');\n\n\t\tthis.server = express();\n\n\n\t\tthis.server.use(bodyParser.urlencoded({ extended: true }));\n\t\tthis.server.use(bodyParser.json());\n\t\tthis.server.use('/assets', express.static('web/assets'));\n\t\tthis.server.use('/video', express.static('visio/motion_detection'));\n\n\t\tthis.initSession();\n\t\tthis.initCache();\n\t\tthis.initTemplate();\n\n\t\t// exec('lsusb', (error, stdout, stderr) => {\n\t\t// \tthis.webcamConnect = /(cam|webcam)/g.test(stdout);\n\t\t// \tif(this.webcamConnect){\n\t\t// \t\tthis.motion.start();\n\t\t// \t\tthis.webcamRunning = true;\n\t\t// \t}\n\t\t// });\n\t}\n\n\tset(name, value){\n\t\tlet key;\n\t\tif('object' === typeof name && undefined === value){\n\t\t\tfor(key in name){\n\t\t\t\tthis[key] = name[key];\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tthis[name] = value;\n\t\t}\n\t\treturn this;\n\t}\n\n\tloadRoutes(){\n\t\tlet i = 0, j, sizeAll = loadRoutes.length, sizeRoute, route, routes, dep;\n\t\tfor(; i < sizeAll; i++){\n\t\t\troutes = loadRoutes[i];\n\n\t\t\tfor(j = 0, sizeRoute = routes.length, dep = {}; j < sizeRoute; j++){\n\t\t\t\troute = routes[j];\n\n\t\t\t\tif(route.dep){\n\t\t\t\t\troute.dep.forEach((el) => {\n\t\t\t\t\t\tdep[el] = this[el];\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.server[route.type](route.url, route.call.bind(dep));\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tinitTemplate(){\n\t\tthis.server.set('view engine', 'ejs');\n\t\tthis.server.set('views', 'web/src/views');\n\t}\n\n\tinitCache(){\n\t\tlet assets = {\n\t\t\t\"/assets/app.min.js\": [ \"/assets/app.js\" ]\n\t\t};\n\n\t\tthis.server.use(cachify.setup(assets, {\n\t\t\troot: \"./web/\",\n\t\t\tproduction: (process.env.NODE_ENV != \"development\"),\n\t\t}));\n\t}\n\n\tinitSession(){\n\t\tthis.server.use(session({\n\t\t\tsecret: 'keyboard cat',\n\t\t\tresave: false,\n\t\t\tsaveUninitialized: true,\n\t\t\tcookie: { maxAge: 600000 }\n\t\t}));\n\n\t\tthis.server.use(function (req, res, next) {\n\t\t\tlet sess = req.session;\n\t\t\tif ((sess.views && '/user/login' !== req.originalUrl) || (!sess.views && '/user/login' === req.originalUrl)) {\n\t\t\t\tnext();\n\t\t\t}\n\t\t\telse if(sess.views && '/user/login' === req.originalUrl){\n\t\t\t\tres.redirect('/');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tsess.views = false;\n\t\t\t\tif(req.xhr || req.headers.accept.indexOf('json') > -1){\n\t\t\t\t\tres\n\t\t\t\t\t\t.status(401)\n\t\t\t\t\t\t.json({\n\t\t\t\t\t\t\t\"response\":false,\n\t\t\t\t\t\t\t\"errors\": {\n\t\t\t\t\t\t\t\t\"message\": \"You should be connected for to have access\",\n\t\t\t\t\t\t\t\t\"redirect\":\"/user/login\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tres.redirect('/user/login');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstart(){\n\t\tlet http;\n\t\tif (process.env.NODE_ENV != \"development\"){\n\t\t\tlet fs = require('fs'),\n\t\t\t\t\toptions = {\n\t\t\t\t\t\tkey  : fs.readFileSync('server.key'),\n\t\t\t\t\t\tcert : fs.readFileSync('server.crt')\n\t\t\t\t\t};\n\t\t\thttp = require('https').createServer(options, this.server);\n\t\t}\n\t\telse{\n\t\t\thttp = require('http').createServer(this.server);\n\t\t}\n\n\t\thttp.listen(process.env.PORT || 7070, function () {\n\t\t\tconsole.log('Server is listening...');\n\t\t});\n\t}\n}\n\nexport default Server;\n"
      ]
    },
    "ast": null,
    "mtime": 1470916951855
  },
  "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/load.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nmodule.exports = [\n// API\nrequire(\"./API/config\"), require(\"./API/user\"), require(\"./API/detect\"),\n\n// Page\n\n// Not modified, it's route of index\nrequire(\"./front/index\")];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS93ZWIvc2VydmVyL3JvdXRlcy9sb2FkLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTSxDQUFDLE9BQU8sR0FBRzs7QUFFaEIsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUN2QixPQUFPLENBQUMsWUFBWSxDQUFDLEVBQ3JCLE9BQU8sQ0FBQyxjQUFjLENBQUM7Ozs7O0FBZ0J2QixPQUFPLENBQUMsZUFBZSxDQUFDLENBQ3hCLENBQUMiLCJmaWxlIjoiL2hvbWUvbGJlcnRyYW5kL1TDqWzDqWNoYXJnZW1lbnRzL1BFUlNPL3N0YXJnYXRlL3dlYi9zZXJ2ZXIvcm91dGVzL2xvYWQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IFtcblx0Ly8gQVBJXG5cdHJlcXVpcmUoJy4vQVBJL2NvbmZpZycpLFxuXHRyZXF1aXJlKCcuL0FQSS91c2VyJyksXG5cdHJlcXVpcmUoJy4vQVBJL2RldGVjdCcpLFxuXG5cdC8vIFBhZ2VcblxuXG5cblxuXG5cblxuXG5cblxuXG5cblx0Ly8gTm90IG1vZGlmaWVkLCBpdCdzIHJvdXRlIG9mIGluZGV4XG5cdHJlcXVpcmUoJy4vZnJvbnQvaW5kZXgnKVxuXTsiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/load.js"
      ],
      "names": [],
      "mappings": ";;AAAA,MAAM,CAAC,OAAO,GAAG;;AAEhB,OAAO,CAAC,cAAc,CAAC,EACvB,OAAO,CAAC,YAAY,CAAC,EACrB,OAAO,CAAC,cAAc,CAAC;;;;;AAgBvB,OAAO,CAAC,eAAe,CAAC,CACxB,CAAC",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/load.js",
      "sourcesContent": [
        "module.exports = [\n\t// API\n\trequire('./API/config'),\n\trequire('./API/user'),\n\trequire('./API/detect'),\n\n\t// Page\n\n\n\n\n\n\n\n\n\n\n\n\n\t// Not modified, it's route of index\n\trequire('./front/index')\n];"
      ]
    },
    "ast": null,
    "mtime": 1470899860554
  },
  "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/config.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nmodule.exports = [{\n\turl: \"/api/config\",\n\ttype: \"get\",\n\tdep: [\"webcamRunning\", \"webcamConnect\", \"motion\"],\n\tcall: function call(req, res) {\n\t\tres.status(200).json({\n\t\t\tresponse: {\n\t\t\t\twebcam: {\n\t\t\t\t\tstream: this.webcamRunning,\n\t\t\t\t\tconnect: this.webcamConnect\n\t\t\t\t}\n\t\t\t} });\n\t}\n}, {\n\turl: \"/api/config\",\n\ttype: \"post\",\n\tdep: [\"webcamRunning\", \"webcamConnect\", \"motion\"],\n\tcall: function call(req, res) {\n\t\tif (req.body.name && undefined !== req.body.value) {\n\t\t\tswitch (req.body.name) {\n\t\t\t\tcase \"webcam\":\n\t\t\t\t\tif (req.body.value) {\n\t\t\t\t\t\tthis.motion.start();\n\t\t\t\t\t\tthis.webcamRunning = true;\n\t\t\t\t\t} else if (webcamRunning) {\n\t\t\t\t\t\tthis.motion.stop();\n\t\t\t\t\t\tthis.webcamRunning = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tres.status(200).json({\n\t\t\t\tresponse: {\n\t\t\t\t\twebcam: {\n\t\t\t\t\t\tstream: this.webcamRunning,\n\t\t\t\t\t\tconnect: this.webcamConnect\n\t\t\t\t\t}\n\t\t\t\t} });\n\t\t} else {\n\t\t\tres.status(500).json({\n\t\t\t\tresponse: false,\n\t\t\t\terrors: {\n\t\t\t\t\tmessage: \"You should be connected for to have access\",\n\t\t\t\t\tredirect: \"/user/login\"\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS93ZWIvc2VydmVyL3JvdXRlcy9BUEkvY29uZmlnLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O2lCQUFlLENBQ2Q7QUFDQyxNQUFPLGFBQWE7QUFDcEIsT0FBUSxLQUFLO0FBQ2IsTUFBTyxDQUFDLGVBQWUsRUFBRSxlQUFlLEVBQUUsUUFBUSxDQUFDO0FBQ25ELE9BQVEsY0FBUyxHQUFHLEVBQUUsR0FBRyxFQUFDO0FBQ3pCLEtBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ3BCLGFBQVk7QUFDWCxZQUFVO0FBQ1QsYUFBVSxJQUFJLENBQUMsYUFBYTtBQUM1QixjQUFXLElBQUksQ0FBQyxhQUFhO0tBQzdCO0lBQ0QsRUFDRCxDQUFDLENBQUM7RUFDSDtDQUNELEVBQ0Q7QUFDQyxNQUFPLGFBQWE7QUFDcEIsT0FBUSxNQUFNO0FBQ2QsTUFBTyxDQUFDLGVBQWUsRUFBRSxlQUFlLEVBQUUsUUFBUSxDQUFDO0FBQ25ELE9BQVEsY0FBUyxHQUFHLEVBQUUsR0FBRyxFQUFDO0FBQ3pCLE1BQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksU0FBUyxLQUFLLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFDO0FBQ2hELFdBQVEsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJO0FBQ3BCLFNBQUssUUFBUTtBQUNaLFNBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUM7QUFDakIsVUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUNwQixVQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztNQUMxQixNQUNJLElBQUcsYUFBYSxFQUFDO0FBQ3JCLFVBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDbkIsVUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7TUFDM0I7QUFDRCxXQUFNO0FBQUEsSUFDUDtBQUNELE1BQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ3BCLGNBQVk7QUFDWCxhQUFVO0FBQ1QsY0FBVSxJQUFJLENBQUMsYUFBYTtBQUM1QixlQUFXLElBQUksQ0FBQyxhQUFhO01BQzdCO0tBQ0QsRUFDRCxDQUFDLENBQUM7R0FDSCxNQUNHO0FBQ0gsTUFBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDcEIsY0FBVyxLQUFLO0FBQ2hCLFlBQVU7QUFDVCxjQUFXLDRDQUE0QztBQUN2RCxlQUFXLGFBQWE7S0FDeEI7SUFDRCxDQUFDLENBQUM7R0FDSDtFQUNEO0NBQ0QsQ0FDRCIsImZpbGUiOiIvaG9tZS9sYmVydHJhbmQvVMOpbMOpY2hhcmdlbWVudHMvUEVSU08vc3RhcmdhdGUvd2ViL3NlcnZlci9yb3V0ZXMvQVBJL2NvbmZpZy5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IFtcblx0e1xuXHRcdCd1cmwnOiAnL2FwaS9jb25maWcnLFxuXHRcdCd0eXBlJzogJ2dldCcsXG5cdFx0J2RlcCc6IFsnd2ViY2FtUnVubmluZycsICd3ZWJjYW1Db25uZWN0JywgJ21vdGlvbiddLFxuXHRcdCdjYWxsJzogZnVuY3Rpb24ocmVxLCByZXMpe1xuXHRcdFx0cmVzLnN0YXR1cygyMDApLmpzb24oe1xuXHRcdFx0XHRcInJlc3BvbnNlXCI6IHtcblx0XHRcdFx0XHQnd2ViY2FtJzoge1xuXHRcdFx0XHRcdFx0J3N0cmVhbSc6IHRoaXMud2ViY2FtUnVubmluZyxcblx0XHRcdFx0XHRcdCdjb25uZWN0JzogdGhpcy53ZWJjYW1Db25uZWN0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LFxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9LFxuXHR7XG5cdFx0J3VybCc6ICcvYXBpL2NvbmZpZycsXG5cdFx0J3R5cGUnOiAncG9zdCcsXG5cdFx0J2RlcCc6IFsnd2ViY2FtUnVubmluZycsICd3ZWJjYW1Db25uZWN0JywgJ21vdGlvbiddLFxuXHRcdCdjYWxsJzogZnVuY3Rpb24ocmVxLCByZXMpe1xuXHRcdFx0aWYocmVxLmJvZHkubmFtZSAmJiB1bmRlZmluZWQgIT09IHJlcS5ib2R5LnZhbHVlKXtcblx0XHRcdFx0c3dpdGNoIChyZXEuYm9keS5uYW1lKSB7XG5cdFx0XHRcdFx0Y2FzZSAnd2ViY2FtJzpcblx0XHRcdFx0XHRcdGlmKHJlcS5ib2R5LnZhbHVlKXtcblx0XHRcdFx0XHRcdFx0dGhpcy5tb3Rpb24uc3RhcnQoKTtcblx0XHRcdFx0XHRcdFx0dGhpcy53ZWJjYW1SdW5uaW5nID0gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2UgaWYod2ViY2FtUnVubmluZyl7XG5cdFx0XHRcdFx0XHRcdHRoaXMubW90aW9uLnN0b3AoKTtcblx0XHRcdFx0XHRcdFx0dGhpcy53ZWJjYW1SdW5uaW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXMuc3RhdHVzKDIwMCkuanNvbih7XG5cdFx0XHRcdFx0XCJyZXNwb25zZVwiOiB7XG5cdFx0XHRcdFx0XHQnd2ViY2FtJzoge1xuXHRcdFx0XHRcdFx0XHQnc3RyZWFtJzogdGhpcy53ZWJjYW1SdW5uaW5nLFxuXHRcdFx0XHRcdFx0XHQnY29ubmVjdCc6IHRoaXMud2ViY2FtQ29ubmVjdFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZXtcblx0XHRcdFx0cmVzLnN0YXR1cyg1MDApLmpzb24oe1xuXHRcdFx0XHRcdFwicmVzcG9uc2VcIjpmYWxzZSxcblx0XHRcdFx0XHRcImVycm9yc1wiOiB7XG5cdFx0XHRcdFx0XHRcIm1lc3NhZ2VcIjogXCJZb3Ugc2hvdWxkIGJlIGNvbm5lY3RlZCBmb3IgdG8gaGF2ZSBhY2Nlc3NcIixcblx0XHRcdFx0XHRcdFwicmVkaXJlY3RcIjpcIi91c2VyL2xvZ2luXCJcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcbl07XG5cbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/config.js"
      ],
      "names": [],
      "mappings": ";;iBAAe,CACd;AACC,MAAO,aAAa;AACpB,OAAQ,KAAK;AACb,MAAO,CAAC,eAAe,EAAE,eAAe,EAAE,QAAQ,CAAC;AACnD,OAAQ,cAAS,GAAG,EAAE,GAAG,EAAC;AACzB,KAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;AACpB,aAAY;AACX,YAAU;AACT,aAAU,IAAI,CAAC,aAAa;AAC5B,cAAW,IAAI,CAAC,aAAa;KAC7B;IACD,EACD,CAAC,CAAC;EACH;CACD,EACD;AACC,MAAO,aAAa;AACpB,OAAQ,MAAM;AACd,MAAO,CAAC,eAAe,EAAE,eAAe,EAAE,QAAQ,CAAC;AACnD,OAAQ,cAAS,GAAG,EAAE,GAAG,EAAC;AACzB,MAAG,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,SAAS,KAAK,GAAG,CAAC,IAAI,CAAC,KAAK,EAAC;AAChD,WAAQ,GAAG,CAAC,IAAI,CAAC,IAAI;AACpB,SAAK,QAAQ;AACZ,SAAG,GAAG,CAAC,IAAI,CAAC,KAAK,EAAC;AACjB,UAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;AACpB,UAAI,CAAC,aAAa,GAAG,IAAI,CAAC;MAC1B,MACI,IAAG,aAAa,EAAC;AACrB,UAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;AACnB,UAAI,CAAC,aAAa,GAAG,KAAK,CAAC;MAC3B;AACD,WAAM;AAAA,IACP;AACD,MAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;AACpB,cAAY;AACX,aAAU;AACT,cAAU,IAAI,CAAC,aAAa;AAC5B,eAAW,IAAI,CAAC,aAAa;MAC7B;KACD,EACD,CAAC,CAAC;GACH,MACG;AACH,MAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;AACpB,cAAW,KAAK;AAChB,YAAU;AACT,cAAW,4CAA4C;AACvD,eAAW,aAAa;KACxB;IACD,CAAC,CAAC;GACH;EACD;CACD,CACD",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/config.js",
      "sourcesContent": [
        "export default [\n\t{\n\t\t'url': '/api/config',\n\t\t'type': 'get',\n\t\t'dep': ['webcamRunning', 'webcamConnect', 'motion'],\n\t\t'call': function(req, res){\n\t\t\tres.status(200).json({\n\t\t\t\t\"response\": {\n\t\t\t\t\t'webcam': {\n\t\t\t\t\t\t'stream': this.webcamRunning,\n\t\t\t\t\t\t'connect': this.webcamConnect\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t'url': '/api/config',\n\t\t'type': 'post',\n\t\t'dep': ['webcamRunning', 'webcamConnect', 'motion'],\n\t\t'call': function(req, res){\n\t\t\tif(req.body.name && undefined !== req.body.value){\n\t\t\t\tswitch (req.body.name) {\n\t\t\t\t\tcase 'webcam':\n\t\t\t\t\t\tif(req.body.value){\n\t\t\t\t\t\t\tthis.motion.start();\n\t\t\t\t\t\t\tthis.webcamRunning = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(webcamRunning){\n\t\t\t\t\t\t\tthis.motion.stop();\n\t\t\t\t\t\t\tthis.webcamRunning = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tres.status(200).json({\n\t\t\t\t\t\"response\": {\n\t\t\t\t\t\t'webcam': {\n\t\t\t\t\t\t\t'stream': this.webcamRunning,\n\t\t\t\t\t\t\t'connect': this.webcamConnect\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tres.status(500).json({\n\t\t\t\t\t\"response\":false,\n\t\t\t\t\t\"errors\": {\n\t\t\t\t\t\t\"message\": \"You should be connected for to have access\",\n\t\t\t\t\t\t\"redirect\":\"/user/login\"\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n];\n\n"
      ]
    },
    "ast": null,
    "mtime": 1470899860554
  },
  "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/user.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nvar ConfigAdmin = require(process.cwd() + \"/config/web/admin\");\n\nmodule.exports = [{\n\turl: \"/user/logout\",\n\ttype: \"get\",\n\tcall: function call(req, res) {\n\t\tvar sess = req.session;\n\t\tsess.destroy(function () {\n\t\t\tres.status(200).json({\n\t\t\t\tresponse: true\n\t\t\t});\n\t\t});\n\t}\n}, {\n\turl: \"/user/login\",\n\ttype: \"post\",\n\tcall: function call(req, res) {\n\t\tif (req.body.name == ConfigAdmin.user && req.body.password == ConfigAdmin.password) {\n\t\t\tvar sess = req.session;\n\t\t\tsess.views = true;\n\t\t\tres.status(200).json({\n\t\t\t\tresponse: true\n\t\t\t});\n\t\t} else {\n\t\t\tres.status(403).json({\n\t\t\t\tresponse: false,\n\t\t\t\terrors: {\n\t\t\t\t\tmessage: \"Is not good user name or password\"\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS93ZWIvc2VydmVyL3JvdXRlcy9BUEkvdXNlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksV0FBVyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsbUJBQW1CLENBQUMsQ0FBQzs7aUJBRWhELENBQ2Q7QUFDQyxNQUFPLGNBQWM7QUFDckIsT0FBUSxLQUFLO0FBQ2IsT0FBUSxjQUFTLEdBQUcsRUFBRSxHQUFHLEVBQUM7QUFDekIsTUFBSSxJQUFJLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQztBQUN2QixNQUFJLENBQUMsT0FBTyxDQUFDLFlBQVU7QUFDdEIsTUFBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDcEIsY0FBVyxJQUFJO0lBQ2YsQ0FBQyxDQUFDO0dBQ0gsQ0FBQyxDQUFDO0VBQ0g7Q0FDRCxFQUNEO0FBQ0MsTUFBTyxhQUFhO0FBQ3BCLE9BQVEsTUFBTTtBQUNkLE9BQVEsY0FBUyxHQUFHLEVBQUUsR0FBRyxFQUFDO0FBQ3pCLE1BQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksV0FBVyxDQUFDLElBQUksSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxXQUFXLENBQUMsUUFBUSxFQUFDO0FBQ2pGLE9BQUksSUFBSSxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUM7QUFDdkIsT0FBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7QUFDbEIsTUFBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDcEIsY0FBVyxJQUFJO0lBQ2YsQ0FBQyxDQUFDO0dBQ0gsTUFDRztBQUNILE1BQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ3BCLGNBQVcsS0FBSztBQUNoQixZQUFVO0FBQ1QsY0FBVyxtQ0FBbUM7S0FDOUM7SUFDRCxDQUFDLENBQUM7R0FDSDtFQUNEO0NBQ0QsQ0FDRCIsImZpbGUiOiIvaG9tZS9sYmVydHJhbmQvVMOpbMOpY2hhcmdlbWVudHMvUEVSU08vc3RhcmdhdGUvd2ViL3NlcnZlci9yb3V0ZXMvQVBJL3VzZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgQ29uZmlnQWRtaW4gPSByZXF1aXJlKHByb2Nlc3MuY3dkKCkgKyAnL2NvbmZpZy93ZWIvYWRtaW4nKTtcblxuZXhwb3J0IGRlZmF1bHQgW1xuXHR7XG5cdFx0J3VybCc6ICcvdXNlci9sb2dvdXQnLFxuXHRcdCd0eXBlJzogJ2dldCcsXG5cdFx0J2NhbGwnOiBmdW5jdGlvbihyZXEsIHJlcyl7XG5cdFx0XHRsZXQgc2VzcyA9IHJlcS5zZXNzaW9uO1xuXHRcdFx0c2Vzcy5kZXN0cm95KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcblx0XHRcdFx0XHRcInJlc3BvbnNlXCI6dHJ1ZVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblx0e1xuXHRcdCd1cmwnOiAnL3VzZXIvbG9naW4nLFxuXHRcdCd0eXBlJzogJ3Bvc3QnLFxuXHRcdCdjYWxsJzogZnVuY3Rpb24ocmVxLCByZXMpe1xuXHRcdFx0aWYocmVxLmJvZHkubmFtZSA9PSBDb25maWdBZG1pbi51c2VyICYmIHJlcS5ib2R5LnBhc3N3b3JkID09IENvbmZpZ0FkbWluLnBhc3N3b3JkKXtcblx0XHRcdFx0dmFyIHNlc3MgPSByZXEuc2Vzc2lvbjtcblx0XHRcdFx0c2Vzcy52aWV3cyA9IHRydWU7XG5cdFx0XHRcdHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcblx0XHRcdFx0XHRcInJlc3BvbnNlXCI6dHJ1ZVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdGVsc2V7XG5cdFx0XHRcdHJlcy5zdGF0dXMoNDAzKS5qc29uKHtcblx0XHRcdFx0XHRcInJlc3BvbnNlXCI6ZmFsc2UsXG5cdFx0XHRcdFx0XCJlcnJvcnNcIjoge1xuXHRcdFx0XHRcdFx0XCJtZXNzYWdlXCI6IFwiSXMgbm90IGdvb2QgdXNlciBuYW1lIG9yIHBhc3N3b3JkXCJcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/user.js"
      ],
      "names": [],
      "mappings": ";;AAAA,IAAI,WAAW,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,mBAAmB,CAAC,CAAC;;iBAEhD,CACd;AACC,MAAO,cAAc;AACrB,OAAQ,KAAK;AACb,OAAQ,cAAS,GAAG,EAAE,GAAG,EAAC;AACzB,MAAI,IAAI,GAAG,GAAG,CAAC,OAAO,CAAC;AACvB,MAAI,CAAC,OAAO,CAAC,YAAU;AACtB,MAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;AACpB,cAAW,IAAI;IACf,CAAC,CAAC;GACH,CAAC,CAAC;EACH;CACD,EACD;AACC,MAAO,aAAa;AACpB,OAAQ,MAAM;AACd,OAAQ,cAAS,GAAG,EAAE,GAAG,EAAC;AACzB,MAAG,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,WAAW,CAAC,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC,QAAQ,IAAI,WAAW,CAAC,QAAQ,EAAC;AACjF,OAAI,IAAI,GAAG,GAAG,CAAC,OAAO,CAAC;AACvB,OAAI,CAAC,KAAK,GAAG,IAAI,CAAC;AAClB,MAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;AACpB,cAAW,IAAI;IACf,CAAC,CAAC;GACH,MACG;AACH,MAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;AACpB,cAAW,KAAK;AAChB,YAAU;AACT,cAAW,mCAAmC;KAC9C;IACD,CAAC,CAAC;GACH;EACD;CACD,CACD",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/user.js",
      "sourcesContent": [
        "var ConfigAdmin = require(process.cwd() + '/config/web/admin');\n\nexport default [\n\t{\n\t\t'url': '/user/logout',\n\t\t'type': 'get',\n\t\t'call': function(req, res){\n\t\t\tlet sess = req.session;\n\t\t\tsess.destroy(function(){\n\t\t\t\tres.status(200).json({\n\t\t\t\t\t\"response\":true\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\t{\n\t\t'url': '/user/login',\n\t\t'type': 'post',\n\t\t'call': function(req, res){\n\t\t\tif(req.body.name == ConfigAdmin.user && req.body.password == ConfigAdmin.password){\n\t\t\t\tvar sess = req.session;\n\t\t\t\tsess.views = true;\n\t\t\t\tres.status(200).json({\n\t\t\t\t\t\"response\":true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tres.status(403).json({\n\t\t\t\t\t\"response\":false,\n\t\t\t\t\t\"errors\": {\n\t\t\t\t\t\t\"message\": \"Is not good user name or password\"\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n];\n"
      ]
    },
    "ast": null,
    "mtime": 1470899860554
  },
  "/home/lbertrand/Téléchargements/PERSO/stargate/config/web/admin.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nmodule.exports = {\n\tuser: \"lbertrand\",\n\tpassword: \"password\"\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS9jb25maWcvd2ViL2FkbWluLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O2lCQUFlO0FBQ2QsT0FBUSxXQUFXO0FBQ25CLFdBQVksVUFBVTtDQUN0QiIsImZpbGUiOiIvaG9tZS9sYmVydHJhbmQvVMOpbMOpY2hhcmdlbWVudHMvUEVSU08vc3RhcmdhdGUvY29uZmlnL3dlYi9hZG1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IHtcblx0J3VzZXInOiAnbGJlcnRyYW5kJyxcblx0J3Bhc3N3b3JkJzogJ3Bhc3N3b3JkJ1xufTsiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/config/web/admin.js"
      ],
      "names": [],
      "mappings": ";;iBAAe;AACd,OAAQ,WAAW;AACnB,WAAY,UAAU;CACtB",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/config/web/admin.js",
      "sourcesContent": [
        "export default {\n\t'user': 'lbertrand',\n\t'password': 'password'\n};"
      ]
    },
    "ast": null,
    "mtime": 1470899860538
  },
  "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/detect.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nvar ConfigAdmin = require(process.cwd() + \"/config/web/admin\");\n\nvar fs = require(\"fs\");\n\nmodule.exports = [{\n\turl: \"/api/detect\",\n\ttype: \"get\",\n\tcall: function call(req, res) {\n\n\t\tfs.readdir(process.cwd() + \"/visio/motion_detection/\", function (err, files) {\n\t\t\tif (err) {\n\t\t\t\tres.status(200).json({\n\t\t\t\t\tresponse: false\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tres.status(200).json({\n\t\t\t\t\tresponse: {\n\t\t\t\t\t\tvideos: files.map(function (el) {\n\t\t\t\t\t\t\treturn { name: el };\n\t\t\t\t\t\t})\n\t\t\t\t\t} });\n\t\t\t}\n\t\t});\n\t}\n}];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS93ZWIvc2VydmVyL3JvdXRlcy9BUEkvZGV0ZWN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSSxXQUFXLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsR0FBRyxtQkFBbUIsQ0FBQyxDQUFDOztBQUUvRCxJQUFJLEVBQUUsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7O2lCQUVSLENBQ2Q7QUFDQyxNQUFPLGFBQWE7QUFDcEIsT0FBUSxLQUFLO0FBQ2IsT0FBUSxjQUFTLEdBQUcsRUFBRSxHQUFHLEVBQUM7O0FBRXpCLElBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxHQUFHLDBCQUEwQixFQUFFLFVBQVMsR0FBRyxFQUFFLEtBQUssRUFBQztBQUMxRSxPQUFHLEdBQUcsRUFBQztBQUNOLE9BQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ3BCLGVBQVcsS0FBSztLQUNoQixDQUFDLENBQUM7SUFDSCxNQUNHO0FBQ0gsT0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDcEIsZUFBWTtBQUNYLFlBQU0sRUFBRSxLQUFLLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBRSxFQUFLO0FBQUMsY0FBTyxFQUFDLElBQUksRUFBRSxFQUFFLEVBQUMsQ0FBQztPQUFDLENBQUM7TUFDL0MsRUFDRCxDQUFDLENBQUM7SUFDSDtHQUNELENBQUMsQ0FBQztFQUNIO0NBQ0QsQ0FDRCIsImZpbGUiOiIvaG9tZS9sYmVydHJhbmQvVMOpbMOpY2hhcmdlbWVudHMvUEVSU08vc3RhcmdhdGUvd2ViL3NlcnZlci9yb3V0ZXMvQVBJL2RldGVjdC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBDb25maWdBZG1pbiA9IHJlcXVpcmUocHJvY2Vzcy5jd2QoKSArICcvY29uZmlnL3dlYi9hZG1pbicpO1xuXG52YXIgZnMgPSByZXF1aXJlKCdmcycpO1xuXG5leHBvcnQgZGVmYXVsdCBbXG5cdHtcblx0XHQndXJsJzogJy9hcGkvZGV0ZWN0Jyxcblx0XHQndHlwZSc6ICdnZXQnLFxuXHRcdCdjYWxsJzogZnVuY3Rpb24ocmVxLCByZXMpe1xuXG5cdFx0XHRmcy5yZWFkZGlyKHByb2Nlc3MuY3dkKCkgKyAnL3Zpc2lvL21vdGlvbl9kZXRlY3Rpb24vJywgZnVuY3Rpb24oZXJyLCBmaWxlcyl7XG5cdFx0XHRcdGlmKGVycil7XG5cdFx0XHRcdFx0cmVzLnN0YXR1cygyMDApLmpzb24oe1xuXHRcdFx0XHRcdFx0XCJyZXNwb25zZVwiOmZhbHNlXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZXtcblx0XHRcdFx0XHRyZXMuc3RhdHVzKDIwMCkuanNvbih7XG5cdFx0XHRcdFx0XHRcInJlc3BvbnNlXCI6IHtcblx0XHRcdFx0XHRcdFx0dmlkZW9zOiBmaWxlcy5tYXAoKGVsKSA9PiB7cmV0dXJuIHtuYW1lOiBlbH07fSlcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/detect.js"
      ],
      "names": [],
      "mappings": ";;AAAA,IAAI,WAAW,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,mBAAmB,CAAC,CAAC;;AAE/D,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;;iBAER,CACd;AACC,MAAO,aAAa;AACpB,OAAQ,KAAK;AACb,OAAQ,cAAS,GAAG,EAAE,GAAG,EAAC;;AAEzB,IAAE,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,0BAA0B,EAAE,UAAS,GAAG,EAAE,KAAK,EAAC;AAC1E,OAAG,GAAG,EAAC;AACN,OAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;AACpB,eAAW,KAAK;KAChB,CAAC,CAAC;IACH,MACG;AACH,OAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;AACpB,eAAY;AACX,YAAM,EAAE,KAAK,CAAC,GAAG,CAAC,UAAC,EAAE,EAAK;AAAC,cAAO,EAAC,IAAI,EAAE,EAAE,EAAC,CAAC;OAAC,CAAC;MAC/C,EACD,CAAC,CAAC;IACH;GACD,CAAC,CAAC;EACH;CACD,CACD",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/API/detect.js",
      "sourcesContent": [
        "var ConfigAdmin = require(process.cwd() + '/config/web/admin');\n\nvar fs = require('fs');\n\nexport default [\n\t{\n\t\t'url': '/api/detect',\n\t\t'type': 'get',\n\t\t'call': function(req, res){\n\n\t\t\tfs.readdir(process.cwd() + '/visio/motion_detection/', function(err, files){\n\t\t\t\tif(err){\n\t\t\t\t\tres.status(200).json({\n\t\t\t\t\t\t\"response\":false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tres.status(200).json({\n\t\t\t\t\t\t\"response\": {\n\t\t\t\t\t\t\tvideos: files.map((el) => {return {name: el};})\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n];\n"
      ]
    },
    "ast": null,
    "mtime": 1470899860554
  },
  "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/front/index.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nmodule.exports = [{\n\turl: \"*\",\n\ttype: \"get\",\n\tcall: function call(req, res) {\n\t\tres.render(\"template\", {\n\t\t\toutput: \"\"\n\t\t});\n\t}\n}];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS93ZWIvc2VydmVyL3JvdXRlcy9mcm9udC9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztpQkFBZSxDQUNkO0FBQ0MsTUFBTyxHQUFHO0FBQ1YsT0FBUSxLQUFLO0FBQ2IsT0FBUSxjQUFTLEdBQUcsRUFBRSxHQUFHLEVBQUM7QUFDekIsS0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUU7QUFDdEIsU0FBTSxFQUFFLEVBQUU7R0FDVixDQUFDLENBQUM7RUFDSDtDQUNELENBQ0QiLCJmaWxlIjoiL2hvbWUvbGJlcnRyYW5kL1TDqWzDqWNoYXJnZW1lbnRzL1BFUlNPL3N0YXJnYXRlL3dlYi9zZXJ2ZXIvcm91dGVzL2Zyb250L2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgW1xuXHR7XG5cdFx0J3VybCc6ICcqJyxcblx0XHQndHlwZSc6ICdnZXQnLFxuXHRcdCdjYWxsJzogZnVuY3Rpb24ocmVxLCByZXMpe1xuXHRcdFx0cmVzLnJlbmRlcigndGVtcGxhdGUnLCB7XG5cdFx0XHRcdG91dHB1dDogJydcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/front/index.js"
      ],
      "names": [],
      "mappings": ";;iBAAe,CACd;AACC,MAAO,GAAG;AACV,OAAQ,KAAK;AACb,OAAQ,cAAS,GAAG,EAAE,GAAG,EAAC;AACzB,KAAG,CAAC,MAAM,CAAC,UAAU,EAAE;AACtB,SAAM,EAAE,EAAE;GACV,CAAC,CAAC;EACH;CACD,CACD",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/web/server/routes/front/index.js",
      "sourcesContent": [
        "export default [\n\t{\n\t\t'url': '*',\n\t\t'type': 'get',\n\t\t'call': function(req, res){\n\t\t\tres.render('template', {\n\t\t\t\toutput: ''\n\t\t\t});\n\t\t}\n\t}\n];\n"
      ]
    },
    "ast": null,
    "mtime": 1470899860554
  },
  "/home/lbertrand/Téléchargements/PERSO/stargate/web/src/utils/motion.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nvar spawn = require(\"child_process\").spawn;\nvar _ = require(\"lodash\");\n\nvar shell = require(\"shelljs\");\n\nvar Emitter = require(\"events\").EventEmitter;\nvar util = require(\"util\");\n\nvar supportedVersions = [\"3_2_12\", \"3_2_12_git20140228\"];\n\nvar Motion = function Motion(path) {\n\n  if (path && !shell.test(\"-e\", path)) {\n    shell.echo(\"Sorry, this module cannot find motion on given path: \" + path);\n    process.exit(1);\n  } else if (!shell.which(\"motion\")) {\n    shell.echo(\"Sorry, this module requires Motion to be installed\");\n    process.exit(1);\n  }\n\n  this.motionBin = path || \"motion\";\n  this.version = this.getVersion();\n  console.log(supportedVersions);\n  if (!_.includes(supportedVersions, this.version)) {\n    shell.echo(\"Sorry, motion version \" + this.version + \" is not supported\");\n    process.exit(1);\n  }\n\n  this.configFile = null;\n  this.motion = null;\n\n  this.httpBackendStarted = false;\n  this.streamStarted = false;\n\n  this.messageArray = [{ version: \"3_2_12\", regex: /^motion-httpd: waiting for data on port TCP (\\d+)/, action: \"backend\" }, { version: \"3_2_12\", regex: /^Started stream webcam server in port (\\d+)/, action: \"stream\" }, { version: \"3_2_12_git20140228\", regex: /httpd_run: motion-httpd: waiting for data on (localhost|\\d\\.\\d\\.\\d\\.\\d) port TCP (\\d+)/, match: 2, action: \"backend\" }, { version: \"3_2_12_git20140228\", regex: /motion_init: Started motion-stream server in port (\\d+).*$/, action: \"stream\" }];\n};\n\nutil.inherits(Motion, Emitter);\n\nMotion.prototype.getVersion = function () {\n  var helpCmd = this.motionBin + \" -h | head -n 1\";\n  var versionRegEx = /^motion Version ([\\d\\.\\+a-z]+), .*$/;\n  var version = shell.exec(helpCmd, { silent: true }).stdout.replace(/\\n/, \"\");\n  if (version === \"\") {\n    shell.echo(\"Sorry, cannot determine Motion version for given Motion binary on : \" + this.motionBin);\n    process.exit(1);\n  } else {\n    var res = versionRegEx.exec(version);\n    if (res) {\n      return res[1].replace(/\\./g, \"_\").replace(/\\+/g, \"_\");\n    } else {\n      shell.echo(\"Sorry, cannot determine Motion version, or version is not supported\");\n      process.exit(1);\n    }\n  }\n  return null;\n};\n\nMotion.prototype.setConfig = function (configFile) {\n  if (!configFile) {\n    return;\n  }\n  if (!shell.test(\"-e\", configFile)) {\n    shell.echo(\"Sorry, the provided configuration file cannot be found : \" + configFile);\n    //process.exit(1);\n  } else {\n    this.configFile = configFile;\n  }\n};\n\nMotion.prototype.start = function () {\n  var that = this;\n  that.stop();\n  if (!that.configFile) {\n    return;\n  }\n  var args = [\"-n\", \"-d\", \"6\", \"-c\", that.configFile];\n  this.motion = spawn(this.motionBin, args);\n  this.motion.stdout.on(\"data\", function (data) {\n    that.processData(data);\n  });\n  this.motion.stderr.on(\"data\", function (data) {\n    that.processData(data);\n  });\n  this.motion.on(\"close\", function (code) {\n    that.emit(\"exit\", \"child process exited with code \" + code);\n  });\n};\n\nMotion.prototype.stop = function () {\n  if (this.motion) {\n    this.motion.kill();\n  }\n};\n\nMotion.prototype.running = function () {\n  if (this.motion) {\n    return true;\n  }\n  return false;\n};\n\nMotion.prototype.checkMessages = function (msg) {\n  var that = this;\n  var matched = false;\n  var payload = null;\n  that.messageArray.forEach(function (message) {\n    if (message.version !== that.version) {\n      return;\n    }\n    if (message.msg && msg.indexOf(message.msg) !== -1) {\n      matched = message.action;\n    }\n    if (message.regex) {\n      var res = message.regex.exec(msg);\n      if (res) {\n        matched = message.action;\n        var match = message.match || 1;\n        payload = res[match];\n      }\n    }\n  });\n  switch (matched) {\n    case false:\n      break;\n    case \"backend\":\n      that.httpBackendStarted = payload;\n      that.emit(\"msg\", { action: matched, value: payload });\n      break;\n    case \"stream\":\n      that.streamStarted = payload;\n      that.emit(\"msg\", { action: matched, value: payload });\n      break;\n    default:\n      break;\n  }\n};\n\nMotion.prototype.processData = function (data) {\n  var that = this;\n  var regex = /^(\\[[\\dA-Z]+\\]\\ )+(.*)$/g;\n  var strings = data.toString(\"ascii\").split(\"\\n\");\n\n  // var msgs = _.chain(strings)\n  var msgs = strings.filter(function (msg) {\n    return msg !== \"\";\n  }).map(function (line) {\n    return line.replace(\"\\t\", \"\").replace(regex, \"$2\");\n  }).forEach(that.checkMessages.bind(that)).forEach(function (line) {\n    that.emit(\"debug\", line);\n  }).value();\n\n  return msgs;\n};\n\nmodule.exports = Motion;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS93ZWIvc3JjL3V0aWxzL21vdGlvbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksS0FBSyxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQyxLQUFLLENBQUM7QUFDM0MsSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDOztBQUUxQixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7O0FBRS9CLElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxZQUFZLENBQUM7QUFDN0MsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDOztBQUUzQixJQUFJLGlCQUFpQixHQUFHLENBQ3RCLFFBQVEsRUFDUixvQkFBb0IsQ0FDckIsQ0FBQzs7QUFFRixJQUFJLE1BQU0sR0FBRyxnQkFBUyxJQUFJLEVBQUU7O0FBRTFCLE1BQUksSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUU7QUFDbkMsU0FBSyxDQUFDLElBQUksQ0FBQyx1REFBdUQsR0FBRyxJQUFJLENBQUMsQ0FBQztBQUMzRSxXQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0dBQ2pCLE1BQU0sSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUU7QUFDakMsU0FBSyxDQUFDLElBQUksQ0FBQyxvREFBb0QsQ0FBQyxDQUFDO0FBQ2pFLFdBQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7R0FDakI7O0FBRUQsTUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLElBQUksUUFBUSxDQUFDO0FBQ2xDLE1BQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO0FBQ2pDLFNBQU8sQ0FBQyxHQUFH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w6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS93ZWIvc3JjL3V0aWxzL21vdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBzcGF3biA9IHJlcXVpcmUoJ2NoaWxkX3Byb2Nlc3MnKS5zcGF3bjtcbnZhciBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XG5cbnZhciBzaGVsbCA9IHJlcXVpcmUoJ3NoZWxsanMnKTtcblxudmFyIEVtaXR0ZXIgPSByZXF1aXJlKCdldmVudHMnKS5FdmVudEVtaXR0ZXI7XG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKTtcblxudmFyIHN1cHBvcnRlZFZlcnNpb25zID0gW1xuICAnM18yXzEyJyxcbiAgJzNfMl8xMl9naXQyMDE0MDIyOCdcbl07XG5cbnZhciBNb3Rpb24gPSBmdW5jdGlvbihwYXRoKSB7XG5cbiAgaWYgKHBhdGggJiYgIXNoZWxsLnRlc3QoJy1lJywgcGF0aCkpIHtcbiAgICBzaGVsbC5lY2hvKCdTb3JyeSwgdGhpcyBtb2R1bGUgY2Fubm90IGZpbmQgbW90aW9uIG9uIGdpdmVuIHBhdGg6ICcgKyBwYXRoKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH0gZWxzZSBpZiAoIXNoZWxsLndoaWNoKCdtb3Rpb24nKSkge1xuICAgIHNoZWxsLmVjaG8oJ1NvcnJ5LCB0aGlzIG1vZHVsZSByZXF1aXJlcyBNb3Rpb24gdG8gYmUgaW5zdGFsbGVkJyk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgdGhpcy5tb3Rpb25CaW4gPSBwYXRoIHx8ICdtb3Rpb24nO1xuICB0aGlzLnZlcnNpb24gPSB0aGlzLmdldFZlcnNpb24oKTtcbiAgY29uc29sZS5sb2coc3VwcG9ydGVkVmVyc2lvbnMpO1xuICBpZiAoIV8uaW5jbHVkZXMoc3VwcG9ydGVkVmVyc2lvbnMsIHRoaXMudmVyc2lvbikpIHtcbiAgICBzaGVsbC5lY2hvKCdTb3JyeSwgbW90aW9uIHZlcnNpb24gJyArIHRoaXMudmVyc2lvbiArICcgaXMgbm90IHN1cHBvcnRlZCcpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIHRoaXMuY29uZmlnRmlsZSA9IG51bGw7XG4gIHRoaXMubW90aW9uID0gbnVsbDtcblxuICB0aGlzLmh0dHBCYWNrZW5kU3RhcnRlZCA9IGZhbHNlO1xuICB0aGlzLnN0cmVhbVN0YXJ0ZWQgPSBmYWxzZTtcblxuICB0aGlzLm1lc3NhZ2VBcnJheSA9IFtcbiAgICB7dmVyc2lvbjogJzNfMl8xMicsIHJlZ2V4OiAvXm1vdGlvbi1odHRwZDogd2FpdGluZyBmb3IgZGF0YSBvbiBwb3J0IFRDUCAoXFxkKykvLCBhY3Rpb246ICdiYWNrZW5kJ30sXG4gICAge3ZlcnNpb246ICczXzJfMTInLCByZWdleDogL15TdGFydGVkIHN0cmVhbSB3ZWJjYW0gc2VydmVyIGluIHBvcnQgKFxcZCspLywgYWN0aW9uOiAnc3RyZWFtJ30sXG4gICAge3ZlcnNpb246ICczXzJfMTJfZ2l0MjAxNDAyMjgnLCByZWdleDogL2h0dHBkX3J1bjogbW90aW9uLWh0dHBkOiB3YWl0aW5nIGZvciBkYXRhIG9uIChsb2NhbGhvc3R8XFxkXFwuXFxkXFwuXFxkXFwuXFxkKSBwb3J0IFRDUCAoXFxkKykvLCBtYXRjaDogMiwgYWN0aW9uOiAnYmFja2VuZCd9LFxuICAgIHt2ZXJzaW9uOiAnM18yXzEyX2dpdDIwMTQwMjI4JywgcmVnZXg6IC9tb3Rpb25faW5pdDogU3RhcnRlZCBtb3Rpb24tc3RyZWFtIHNlcnZlciBpbiBwb3J0IChcXGQrKS4qJC8sIGFjdGlvbjogJ3N0cmVhbSd9XG4gIF07XG59O1xuXG51dGlsLmluaGVyaXRzKE1vdGlvbiwgRW1pdHRlcik7XG5cbk1vdGlvbi5wcm90b3R5cGUuZ2V0VmVyc2lvbiA9IGZ1bmN0aW9uKCl7XG4gIHZhciBoZWxwQ21kID0gdGhpcy5tb3Rpb25CaW4gKyAnIC1oIHwgaGVhZCAtbiAxJztcbiAgdmFyIHZlcnNpb25SZWdFeCA9IC9ebW90aW9uIFZlcnNpb24gKFtcXGRcXC5cXCthLXpdKyksIC4qJC87XG4gIHZhciB2ZXJzaW9uID0gc2hlbGwuZXhlYyhoZWxwQ21kLCB7c2lsZW50OiB0cnVlfSkuc3Rkb3V0LnJlcGxhY2UoL1xcbi8sICcnKTtcbiAgaWYgKHZlcnNpb24gPT09ICcnKSB7XG4gICAgc2hlbGwuZWNobygnU29ycnksIGNhbm5vdCBkZXRlcm1pbmUgTW90aW9uIHZlcnNpb24gZm9yIGdpdmVuIE1vdGlvbiBiaW5hcnkgb24gOiAnICsgdGhpcy5tb3Rpb25CaW4pO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgcmVzID0gdmVyc2lvblJlZ0V4LmV4ZWModmVyc2lvbik7XG4gICAgaWYgKHJlcykge1xuICAgICAgcmV0dXJuIHJlc1sxXS5yZXBsYWNlKC9cXC4vZywgJ18nKS5yZXBsYWNlKC9cXCsvZywgJ18nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hlbGwuZWNobygnU29ycnksIGNhbm5vdCBkZXRlcm1pbmUgTW90aW9uIHZlcnNpb24sIG9yIHZlcnNpb24gaXMgbm90IHN1cHBvcnRlZCcpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG5cbk1vdGlvbi5wcm90b3R5cGUuc2V0Q29uZmlnID0gZnVuY3Rpb24oY29uZmlnRmlsZSkge1xuICBpZiAoIWNvbmZpZ0ZpbGUpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKCFzaGVsbC50ZXN0KCctZScsIGNvbmZpZ0ZpbGUpKSB7XG4gICAgc2hlbGwuZWNobygnU29ycnksIHRoZSBwcm92aWRlZCBjb25maWd1cmF0aW9uIGZpbGUgY2Fubm90IGJlIGZvdW5kIDogJyArIGNvbmZpZ0ZpbGUpO1xuICAgIC8vcHJvY2Vzcy5leGl0KDEpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuY29uZmlnRmlsZSA9IGNvbmZpZ0ZpbGU7XG4gIH1cbn07XG5cbk1vdGlvbi5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpe1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHRoYXQuc3RvcCgpO1xuICBpZiAoIXRoYXQuY29uZmlnRmlsZSkge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgYXJncyA9IFtcbiAgICAnLW4nLFxuICAgICctZCcsICc2JyxcbiAgICAnLWMnLCB0aGF0LmNvbmZpZ0ZpbGVcbiAgXTtcbiAgdGhpcy5tb3Rpb24gPSBzcGF3bih0aGlzLm1vdGlvbkJpbiwgYXJncyk7XG4gIHRoaXMubW90aW9uLnN0ZG91dC5vbignZGF0YScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgdGhhdC5wcm9jZXNzRGF0YShkYXRhKTtcbiAgfSk7XG4gIHRoaXMubW90aW9uLnN0ZGVyci5vbignZGF0YScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgdGhhdC5wcm9jZXNzRGF0YShkYXRhKTtcbiAgfSk7XG4gIHRoaXMubW90aW9uLm9uKCdjbG9zZScsIGZ1bmN0aW9uIChjb2RlKSB7XG4gICAgdGhhdC5lbWl0KCdleGl0JywgJ2NoaWxkIHByb2Nlc3MgZXhpdGVkIHdpdGggY29kZSAnICsgY29kZSk7XG4gIH0pO1xufTtcblxuTW90aW9uLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLm1vdGlvbikge1xuICAgIHRoaXMubW90aW9uLmtpbGwoKTtcbiAgfVxufTtcblxuTW90aW9uLnByb3RvdHlwZS5ydW5uaW5nID0gZnVuY3Rpb24oKXtcbiAgaWYgKHRoaXMubW90aW9uKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuTW90aW9uLnByb3RvdHlwZS5jaGVja01lc3NhZ2VzID0gZnVuY3Rpb24obXNnKSB7XG4gIHZhciB0aGF0ID0gdGhpcztcbiAgdmFyIG1hdGNoZWQgPSBmYWxzZTtcbiAgdmFyIHBheWxvYWQgPSBudWxsO1xuICB0aGF0Lm1lc3NhZ2VBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgaWYgKG1lc3NhZ2UudmVyc2lvbiAhPT0gdGhhdC52ZXJzaW9uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1zZyAmJiBtc2cuaW5kZXhPZihtZXNzYWdlLm1zZykgIT09IC0xKSB7XG4gICAgICBtYXRjaGVkID0gbWVzc2FnZS5hY3Rpb247XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJlZ2V4KSB7XG4gICAgICB2YXIgcmVzID0gbWVzc2FnZS5yZWdleC5leGVjKG1zZyk7XG4gICAgICBpZiAocmVzKSB7XG4gICAgICAgIG1hdGNoZWQgPSBtZXNzYWdlLmFjdGlvbjtcbiAgICAgICAgdmFyIG1hdGNoID0gbWVzc2FnZS5tYXRjaCB8fCAxO1xuICAgICAgICBwYXlsb2FkID0gcmVzW21hdGNoXTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBzd2l0Y2gobWF0Y2hlZCkge1xuICBjYXNlIGZhbHNlOlxuICAgIGJyZWFrO1xuICBjYXNlICdiYWNrZW5kJzpcbiAgICB0aGF0Lmh0dHBCYWNrZW5kU3RhcnRlZCA9IHBheWxvYWQ7XG4gICAgdGhhdC5lbWl0KCdtc2cnLCB7IGFjdGlvbjogbWF0Y2hlZCwgdmFsdWU6IHBheWxvYWQgfSk7XG4gICAgYnJlYWs7XG4gIGNhc2UgJ3N0cmVhbSc6XG4gICAgdGhhdC5zdHJlYW1TdGFydGVkID0gcGF5bG9hZDtcbiAgICB0aGF0LmVtaXQoJ21zZycsIHsgYWN0aW9uOiBtYXRjaGVkLCB2YWx1ZTogcGF5bG9hZCB9KTtcbiAgICBicmVhaztcbiAgZGVmYXVsdDpcbiAgICBicmVhaztcbiAgfVxufTtcblxuTW90aW9uLnByb3RvdHlwZS5wcm9jZXNzRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB2YXIgcmVnZXggPSAvXihcXFtbXFxkQS1aXStcXF1cXCApKyguKikkL2c7XG4gIHZhciBzdHJpbmdzID0gZGF0YS50b1N0cmluZygnYXNjaWknKS5zcGxpdCgnXFxuJyk7XG5cbiAgLy8gdmFyIG1zZ3MgPSBfLmNoYWluKHN0cmluZ3MpXG4gIHZhciBtc2dzID0gc3RyaW5ncy5maWx0ZXIoZnVuY3Rpb24obXNnKSB7XG4gICAgICByZXR1cm4gbXNnICE9PSAnJztcbiAgICB9KVxuICAgIC5tYXAoZnVuY3Rpb24gKGxpbmUpIHtcbiAgICAgIHJldHVybiBsaW5lLnJlcGxhY2UoJ1xcdCcsICcnKS5yZXBsYWNlKHJlZ2V4LCAnJDInKTtcbiAgICB9KVxuICAgIC5mb3JFYWNoKHRoYXQuY2hlY2tNZXNzYWdlcy5iaW5kKHRoYXQpKVxuICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICB0aGF0LmVtaXQoJ2RlYnVnJywgbGluZSk7XG4gICAgfSlcbiAgICAudmFsdWUoKTtcblxuICByZXR1cm4gbXNncztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTW90aW9uO1xuIl19",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/web/src/utils/motion.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/web/src/utils/motion.js",
      "sourcesContent": [
        "var spawn = require('child_process').spawn;\nvar _ = require('lodash');\n\nvar shell = require('shelljs');\n\nvar Emitter = require('events').EventEmitter;\nvar util = require('util');\n\nvar supportedVersions = [\n  '3_2_12',\n  '3_2_12_git20140228'\n];\n\nvar Motion = function(path) {\n\n  if (path && !shell.test('-e', path)) {\n    shell.echo('Sorry, this module cannot find motion on given path: ' + path);\n    process.exit(1);\n  } else if (!shell.which('motion')) {\n    shell.echo('Sorry, this module requires Motion to be installed');\n    process.exit(1);\n  }\n\n  this.motionBin = path || 'motion';\n  this.version = this.getVersion();\n  console.log(supportedVersions);\n  if (!_.includes(supportedVersions, this.version)) {\n    shell.echo('Sorry, motion version ' + this.version + ' is not supported');\n    process.exit(1);\n  }\n\n  this.configFile = null;\n  this.motion = null;\n\n  this.httpBackendStarted = false;\n  this.streamStarted = false;\n\n  this.messageArray = [\n    {version: '3_2_12', regex: /^motion-httpd: waiting for data on port TCP (\\d+)/, action: 'backend'},\n    {version: '3_2_12', regex: /^Started stream webcam server in port (\\d+)/, action: 'stream'},\n    {version: '3_2_12_git20140228', regex: /httpd_run: motion-httpd: waiting for data on (localhost|\\d\\.\\d\\.\\d\\.\\d) port TCP (\\d+)/, match: 2, action: 'backend'},\n    {version: '3_2_12_git20140228', regex: /motion_init: Started motion-stream server in port (\\d+).*$/, action: 'stream'}\n  ];\n};\n\nutil.inherits(Motion, Emitter);\n\nMotion.prototype.getVersion = function(){\n  var helpCmd = this.motionBin + ' -h | head -n 1';\n  var versionRegEx = /^motion Version ([\\d\\.\\+a-z]+), .*$/;\n  var version = shell.exec(helpCmd, {silent: true}).stdout.replace(/\\n/, '');\n  if (version === '') {\n    shell.echo('Sorry, cannot determine Motion version for given Motion binary on : ' + this.motionBin);\n    process.exit(1);\n  } else {\n    var res = versionRegEx.exec(version);\n    if (res) {\n      return res[1].replace(/\\./g, '_').replace(/\\+/g, '_');\n    } else {\n      shell.echo('Sorry, cannot determine Motion version, or version is not supported');\n      process.exit(1);\n    }\n  }\n  return null;\n};\n\nMotion.prototype.setConfig = function(configFile) {\n  if (!configFile) {\n    return;\n  }\n  if (!shell.test('-e', configFile)) {\n    shell.echo('Sorry, the provided configuration file cannot be found : ' + configFile);\n    //process.exit(1);\n  } else {\n    this.configFile = configFile;\n  }\n};\n\nMotion.prototype.start = function(){\n  var that = this;\n  that.stop();\n  if (!that.configFile) {\n    return;\n  }\n  var args = [\n    '-n',\n    '-d', '6',\n    '-c', that.configFile\n  ];\n  this.motion = spawn(this.motionBin, args);\n  this.motion.stdout.on('data', function (data) {\n    that.processData(data);\n  });\n  this.motion.stderr.on('data', function (data) {\n    that.processData(data);\n  });\n  this.motion.on('close', function (code) {\n    that.emit('exit', 'child process exited with code ' + code);\n  });\n};\n\nMotion.prototype.stop = function() {\n  if (this.motion) {\n    this.motion.kill();\n  }\n};\n\nMotion.prototype.running = function(){\n  if (this.motion) {\n    return true;\n  }\n  return false;\n};\n\nMotion.prototype.checkMessages = function(msg) {\n  var that = this;\n  var matched = false;\n  var payload = null;\n  that.messageArray.forEach(function (message) {\n    if (message.version !== that.version) {\n      return;\n    }\n    if (message.msg && msg.indexOf(message.msg) !== -1) {\n      matched = message.action;\n    }\n    if (message.regex) {\n      var res = message.regex.exec(msg);\n      if (res) {\n        matched = message.action;\n        var match = message.match || 1;\n        payload = res[match];\n      }\n    }\n  });\n  switch(matched) {\n  case false:\n    break;\n  case 'backend':\n    that.httpBackendStarted = payload;\n    that.emit('msg', { action: matched, value: payload });\n    break;\n  case 'stream':\n    that.streamStarted = payload;\n    that.emit('msg', { action: matched, value: payload });\n    break;\n  default:\n    break;\n  }\n};\n\nMotion.prototype.processData = function(data) {\n  var that = this;\n  var regex = /^(\\[[\\dA-Z]+\\]\\ )+(.*)$/g;\n  var strings = data.toString('ascii').split('\\n');\n\n  // var msgs = _.chain(strings)\n  var msgs = strings.filter(function(msg) {\n      return msg !== '';\n    })\n    .map(function (line) {\n      return line.replace('\\t', '').replace(regex, '$2');\n    })\n    .forEach(that.checkMessages.bind(that))\n    .forEach(function (line) {\n      that.emit('debug', line);\n    })\n    .value();\n\n  return msgs;\n};\n\nmodule.exports = Motion;\n"
      ]
    },
    "ast": null,
    "mtime": 1470917018039
  },
  "/home/lbertrand/Téléchargements/PERSO/stargate/config/web/environnement.js:{}:4.7.16": {
    "code": "\"use strict\";\n\nexports.NODE_ENV = \"development\";\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xiZXJ0cmFuZC9Uw6lsw6ljaGFyZ2VtZW50cy9QRVJTTy9zdGFyZ2F0ZS9jb25maWcvd2ViL2Vudmlyb25uZW1lbnQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsUUFBUSxHQUFJLGFBQWEsQ0FBQyIsImZpbGUiOiIvaG9tZS9sYmVydHJhbmQvVMOpbMOpY2hhcmdlbWVudHMvUEVSU08vc3RhcmdhdGUvY29uZmlnL3dlYi9lbnZpcm9ubmVtZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0cy5OT0RFX0VOViAgPSAnZGV2ZWxvcG1lbnQnOyJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "/home/lbertrand/Téléchargements/PERSO/stargate/config/web/environnement.js"
      ],
      "names": [],
      "mappings": ";;AAAA,OAAO,CAAC,QAAQ,GAAI,aAAa,CAAC",
      "file": "/home/lbertrand/Téléchargements/PERSO/stargate/config/web/environnement.js",
      "sourcesContent": [
        "exports.NODE_ENV  = 'development';"
      ]
    },
    "ast": null,
    "mtime": 1470899860538
  }
}